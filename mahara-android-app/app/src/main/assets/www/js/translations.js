// Mahara Platform Translations
const TRANSLATIONS = {
    ar: {
        // Navigation
        'nav.home': 'الرئيسية',
        'nav.services': 'الخدمات',
        'nav.how_it_works': 'كيف يعمل',
        'nav.about': 'من نحن',
        'nav.contact': 'اتصل بنا',

        // Authentication
        'auth.login': 'تسجيل الدخول',
        'auth.register': 'إنشاء حساب',
        'auth.logout': 'تسجيل الخروج',
        'auth.forgot_password': 'نسيت كلمة المرور؟',
        'auth.reset_password': 'إعادة تعيين كلمة المرور',
        'auth.no_account': 'ليس لديك حساب؟',
        'auth.have_account': 'لديك حساب بالفعل؟',

        // Hero Section
        'hero.title': 'اكتشف أفضل الخدمات المحلية في الجزائر',
        'hero.subtitle': 'منصة مهارة تربط بين مقدمي الخدمات المهرة والعملاء في جميع أنحاء الجزائر. احجز خدمتك المطلوبة بسهولة وثقة.',
        'hero.popular_categories': 'الفئات الشائعة:',

        // Search
        'search.placeholder': 'ابحث عن خدمة...',
        'search.button': 'بحث',
        'search.all_wilayas': 'جميع الولايات',

        // Categories
        'categories.title': 'فئات الخدمات',
        'categories.subtitle': 'استكشف مجموعة واسعة من الخدمات المتاحة',
        'categories.home_services': 'خدمات المنزل',
        'categories.education': 'التعليم والتدريب',
        'categories.technology': 'التكنولوجيا والبرمجة',
        'categories.arts': 'الفنون والحرف',
        'categories.personal_care': 'العناية الشخصية',
        'categories.events': 'المناسبات والفعاليات',

        // Featured Services
        'featured.title': 'الخدمات المميزة',
        'featured.subtitle': 'اكتشف أفضل الخدمات المتاحة من مقدمي خدمات موثوقين',
        'featured.view_all': 'عرض جميع الخدمات',

        // How It Works
        'how_it_works.title': 'كيف يعمل مهارة',
        'how_it_works.subtitle': 'ثلاث خطوات بسيطة للحصول على الخدمة التي تحتاجها',
        'how_it_works.step1.title': 'ابحث عن الخدمة',
        'how_it_works.step1.description': 'استخدم محرك البحث للعثور على الخدمة التي تحتاجها في منطقتك',
        'how_it_works.step2.title': 'احجز موعدك',
        'how_it_works.step2.description': 'اختر مقدم الخدمة المناسب واحجز موعدك بسهولة',
        'how_it_works.step3.title': 'قيم التجربة',
        'how_it_works.step3.description': 'بعد الحصول على الخدمة، قيم تجربتك لمساعدة الآخرين',

        // Statistics
        'stats.services': 'خدمة متاحة',
        'stats.providers': 'مقدم خدمة',
        'stats.customers': 'عميل راضي',
        'stats.cities': 'ولاية',

        // Forms
        'form.first_name': 'الاسم الأول',
        'form.last_name': 'الاسم الأخير',
        'form.email': 'البريد الإلكتروني',
        'form.phone': 'رقم الهاتف',
        'form.password': 'كلمة المرور',
        'form.confirm_password': 'تأكيد كلمة المرور',
        'form.user_type': 'نوع الحساب',
        'form.wilaya': 'الولاية',
        'form.city': 'المدينة',
        'form.address': 'العنوان',

        // User Types
        'user_type.customer': 'عميل',
        'user_type.provider': 'مقدم خدمة',

        // User Menu
        'user.profile': 'الملف الشخصي',
        'user.my_services': 'خدماتي',
        'user.my_bookings': 'حجوزاتي',
        'user.notifications': 'الإشعارات',
        'user.settings': 'الإعدادات',

        // Services
        'service.price.negotiable': 'قابل للتفاوض',
        'service.price.fixed': 'سعر ثابت',
        'service.price.hourly': 'بالساعة',
        'service.location.provider': 'في موقع مقدم الخدمة',
        'service.location.customer': 'في موقع العميل',
        'service.location.online': 'عبر الإنترنت',
        'service.location.flexible': 'مرن',

        // Bookings
        'booking.status.pending': 'في الانتظار',
        'booking.status.accepted': 'مقبول',
        'booking.status.rejected': 'مرفوض',
        'booking.status.in_progress': 'قيد التنفيذ',
        'booking.status.completed': 'مكتمل',
        'booking.status.cancelled': 'ملغي',

        // Reviews
        'review.rating': 'التقييم',
        'review.comment': 'التعليق',
        'review.submit': 'إرسال التقييم',

        // Messages
        'message.success.login': 'تم تسجيل الدخول بنجاح',
        'message.success.register': 'تم إنشاء الحساب بنجاح',
        'message.success.logout': 'تم تسجيل الخروج بنجاح',
        'message.error.login': 'خطأ في تسجيل الدخول',
        'message.error.register': 'خطأ في إنشاء الحساب',
        'message.error.network': 'خطأ في الشبكة',
        'message.error.server': 'خطأ في الخادم',

        // Common
        'common.loading': 'جاري التحميل...',
        'common.save': 'حفظ',
        'common.cancel': 'إلغاء',
        'common.delete': 'حذف',
        'common.edit': 'تعديل',
        'common.view': 'عرض',
        'common.back': 'رجوع',
        'common.next': 'التالي',
        'common.previous': 'السابق',
        'common.close': 'إغلاق',
        'common.confirm': 'تأكيد',
        'common.yes': 'نعم',
        'common.no': 'لا',
        'common.or': 'أو',
        'common.and': 'و',
        'common.from': 'من',
        'common.to': 'إلى',
        'common.date': 'التاريخ',
        'common.time': 'الوقت',
        'common.price': 'السعر',
        'common.location': 'الموقع',
        'common.description': 'الوصف',
        'common.name': 'الاسم',
        'common.phone': 'الهاتف',
        'common.email': 'البريد الإلكتروني',
        'common.website': 'الموقع الإلكتروني',
        'common.social_media': 'وسائل التواصل الاجتماعي'
    },

    fr: {
        // Navigation
        'nav.home': 'Accueil',
        'nav.services': 'Services',
        'nav.how_it_works': 'Comment ça marche',
        'nav.about': 'À propos',
        'nav.contact': 'Contact',

        // Authentication
        'auth.login': 'Se connecter',
        'auth.register': 'S\'inscrire',
        'auth.logout': 'Se déconnecter',
        'auth.forgot_password': 'Mot de passe oublié ?',
        'auth.reset_password': 'Réinitialiser le mot de passe',
        'auth.no_account': 'Pas de compte ?',
        'auth.have_account': 'Déjà un compte ?',

        // Hero Section
        'hero.title': 'Découvrez les meilleurs services locaux en Algérie',
        'hero.subtitle': 'Mahara connecte les prestataires de services qualifiés avec les clients à travers l\'Algérie. Réservez votre service en toute simplicité et confiance.',
        'hero.popular_categories': 'Catégories populaires :',

        // Search
        'search.placeholder': 'Rechercher un service...',
        'search.button': 'Rechercher',
        'search.all_wilayas': 'Toutes les wilayas',

        // Categories
        'categories.title': 'Catégories de services',
        'categories.subtitle': 'Explorez une large gamme de services disponibles',
        'categories.home_services': 'Services à domicile',
        'categories.education': 'Éducation et formation',
        'categories.technology': 'Technologie et programmation',
        'categories.arts': 'Arts et artisanat',
        'categories.personal_care': 'Soins personnels',
        'categories.events': 'Événements',

        // Featured Services
        'featured.title': 'Services en vedette',
        'featured.subtitle': 'Découvrez les meilleurs services disponibles de prestataires de confiance',
        'featured.view_all': 'Voir tous les services',

        // How It Works
        'how_it_works.title': 'Comment fonctionne Mahara',
        'how_it_works.subtitle': 'Trois étapes simples pour obtenir le service dont vous avez besoin',
        'how_it_works.step1.title': 'Recherchez le service',
        'how_it_works.step1.description': 'Utilisez le moteur de recherche pour trouver le service dont vous avez besoin dans votre région',
        'how_it_works.step2.title': 'Réservez votre rendez-vous',
        'how_it_works.step2.description': 'Choisissez le prestataire approprié et réservez facilement votre rendez-vous',
        'how_it_works.step3.title': 'Évaluez l\'expérience',
        'how_it_works.step3.description': 'Après avoir reçu le service, évaluez votre expérience pour aider les autres',

        // Statistics
        'stats.services': 'services disponibles',
        'stats.providers': 'prestataires',
        'stats.customers': 'clients satisfaits',
        'stats.cities': 'wilayas',

        // Forms
        'form.first_name': 'Prénom',
        'form.last_name': 'Nom',
        'form.email': 'Email',
        'form.phone': 'Téléphone',
        'form.password': 'Mot de passe',
        'form.confirm_password': 'Confirmer le mot de passe',
        'form.user_type': 'Type de compte',
        'form.wilaya': 'Wilaya',
        'form.city': 'Ville',
        'form.address': 'Adresse',

        // User Types
        'user_type.customer': 'Client',
        'user_type.provider': 'Prestataire',

        // User Menu
        'user.profile': 'Profil',
        'user.my_services': 'Mes services',
        'user.my_bookings': 'Mes réservations',
        'user.notifications': 'Notifications',
        'user.settings': 'Paramètres',

        // Services
        'service.price.negotiable': 'Négociable',
        'service.price.fixed': 'Prix fixe',
        'service.price.hourly': 'Par heure',
        'service.location.provider': 'Chez le prestataire',
        'service.location.customer': 'Chez le client',
        'service.location.online': 'En ligne',
        'service.location.flexible': 'Flexible',

        // Bookings
        'booking.status.pending': 'En attente',
        'booking.status.accepted': 'Accepté',
        'booking.status.rejected': 'Rejeté',
        'booking.status.in_progress': 'En cours',
        'booking.status.completed': 'Terminé',
        'booking.status.cancelled': 'Annulé',

        // Reviews
        'review.rating': 'Note',
        'review.comment': 'Commentaire',
        'review.submit': 'Soumettre l\'évaluation',

        // Messages
        'message.success.login': 'Connexion réussie',
        'message.success.register': 'Inscription réussie',
        'message.success.logout': 'Déconnexion réussie',
        'message.error.login': 'Erreur de connexion',
        'message.error.register': 'Erreur d\'inscription',
        'message.error.network': 'Erreur réseau',
        'message.error.server': 'Erreur serveur',

        // Common
        'common.loading': 'Chargement...',
        'common.save': 'Enregistrer',
        'common.cancel': 'Annuler',
        'common.delete': 'Supprimer',
        'common.edit': 'Modifier',
        'common.view': 'Voir',
        'common.back': 'Retour',
        'common.next': 'Suivant',
        'common.previous': 'Précédent',
        'common.close': 'Fermer',
        'common.confirm': 'Confirmer',
        'common.yes': 'Oui',
        'common.no': 'Non',
        'common.or': 'ou',
        'common.and': 'et',
        'common.from': 'de',
        'common.to': 'à',
        'common.date': 'Date',
        'common.time': 'Heure',
        'common.price': 'Prix',
        'common.location': 'Localisation',
        'common.description': 'Description',
        'common.name': 'Nom',
        'common.phone': 'Téléphone',
        'common.email': 'Email',
        'common.website': 'Site web',
        'common.social_media': 'Réseaux sociaux'
    },

    en: {
        // Navigation
        'nav.home': 'Home',
        'nav.services': 'Services',
        'nav.how_it_works': 'How It Works',
        'nav.about': 'About',
        'nav.contact': 'Contact',

        // Authentication
        'auth.login': 'Login',
        'auth.register': 'Register',
        'auth.logout': 'Logout',
        'auth.forgot_password': 'Forgot Password?',
        'auth.reset_password': 'Reset Password',
        'auth.no_account': 'No account?',
        'auth.have_account': 'Already have an account?',

        // Hero Section
        'hero.title': 'Discover the Best Local Services in Algeria',
        'hero.subtitle': 'Mahara connects skilled service providers with customers across Algeria. Book your needed service with ease and confidence.',
        'hero.popular_categories': 'Popular categories:',

        // Search
        'search.placeholder': 'Search for a service...',
        'search.button': 'Search',
        'search.all_wilayas': 'All wilayas',

        // Categories
        'categories.title': 'Service Categories',
        'categories.subtitle': 'Explore a wide range of available services',
        'categories.home_services': 'Home Services',
        'categories.education': 'Education & Training',
        'categories.technology': 'Technology & Programming',
        'categories.arts': 'Arts & Crafts',
        'categories.personal_care': 'Personal Care',
        'categories.events': 'Events',

        // Featured Services
        'featured.title': 'Featured Services',
        'featured.subtitle': 'Discover the best available services from trusted providers',
        'featured.view_all': 'View All Services',

        // How It Works
        'how_it_works.title': 'How Mahara Works',
        'how_it_works.subtitle': 'Three simple steps to get the service you need',
        'how_it_works.step1.title': 'Search for Service',
        'how_it_works.step1.description': 'Use the search engine to find the service you need in your area',
        'how_it_works.step2.title': 'Book Your Appointment',
        'how_it_works.step2.description': 'Choose the right provider and easily book your appointment',
        'how_it_works.step3.title': 'Rate the Experience',
        'how_it_works.step3.description': 'After receiving the service, rate your experience to help others',

        // Statistics
        'stats.services': 'available services',
        'stats.providers': 'service providers',
        'stats.customers': 'satisfied customers',
        'stats.cities': 'wilayas',

        // Forms
        'form.first_name': 'First Name',
        'form.last_name': 'Last Name',
        'form.email': 'Email',
        'form.phone': 'Phone',
        'form.password': 'Password',
        'form.confirm_password': 'Confirm Password',
        'form.user_type': 'Account Type',
        'form.wilaya': 'Wilaya',
        'form.city': 'City',
        'form.address': 'Address',

        // User Types
        'user_type.customer': 'Customer',
        'user_type.provider': 'Service Provider',

        // User Menu
        'user.profile': 'Profile',
        'user.my_services': 'My Services',
        'user.my_bookings': 'My Bookings',
        'user.notifications': 'Notifications',
        'user.settings': 'Settings',

        // Services
        'service.price.negotiable': 'Negotiable',
        'service.price.fixed': 'Fixed Price',
        'service.price.hourly': 'Per Hour',
        'service.location.provider': 'At Provider Location',
        'service.location.customer': 'At Customer Location',
        'service.location.online': 'Online',
        'service.location.flexible': 'Flexible',

        // Bookings
        'booking.status.pending': 'Pending',
        'booking.status.accepted': 'Accepted',
        'booking.status.rejected': 'Rejected',
        'booking.status.in_progress': 'In Progress',
        'booking.status.completed': 'Completed',
        'booking.status.cancelled': 'Cancelled',

        // Reviews
        'review.rating': 'Rating',
        'review.comment': 'Comment',
        'review.submit': 'Submit Review',

        // Messages
        'message.success.login': 'Login successful',
        'message.success.register': 'Registration successful',
        'message.success.logout': 'Logout successful',
        'message.error.login': 'Login error',
        'message.error.register': 'Registration error',
        'message.error.network': 'Network error',
        'message.error.server': 'Server error',

        // Common
        'common.loading': 'Loading...',
        'common.save': 'Save',
        'common.cancel': 'Cancel',
        'common.delete': 'Delete',
        'common.edit': 'Edit',
        'common.view': 'View',
        'common.back': 'Back',
        'common.next': 'Next',
        'common.previous': 'Previous',
        'common.close': 'Close',
        'common.confirm': 'Confirm',
        'common.yes': 'Yes',
        'common.no': 'No',
        'common.or': 'or',
        'common.and': 'and',
        'common.from': 'from',
        'common.to': 'to',
        'common.date': 'Date',
        'common.time': 'Time',
        'common.price': 'Price',
        'common.location': 'Location',
        'common.description': 'Description',
        'common.name': 'Name',
        'common.phone': 'Phone',
        'common.email': 'Email',
        'common.website': 'Website',
        'common.social_media': 'Social Media'
    }
};

// Translation utility functions
class TranslationManager {
    constructor() {
        this.currentLanguage = this.getStoredLanguage() || CONFIG.APP.DEFAULT_LANGUAGE;
        this.translations = TRANSLATIONS;
    }

    // Get stored language from localStorage
    getStoredLanguage() {
        return localStorage.getItem(CONFIG.STORAGE_KEYS.LANGUAGE);
    }

    // Set and store language
    setLanguage(language) {
        if (CONFIG.APP.SUPPORTED_LANGUAGES.includes(language)) {
            this.currentLanguage = language;
            localStorage.setItem(CONFIG.STORAGE_KEYS.LANGUAGE, language);
            this.updatePageLanguage();
            return true;
        }
        return false;
    }

    // Get current language
    getCurrentLanguage() {
        return this.currentLanguage;
    }

    // Check if language is RTL
    isRTL(language = null) {
        const lang = language || this.currentLanguage;
        return CONFIG.APP.RTL_LANGUAGES.includes(lang);
    }

    // Translate a key
    translate(key, params = {}) {
        const translation = this.translations[this.currentLanguage]?.[key] || key;
        
        // Replace parameters in translation
        let result = translation;
        Object.keys(params).forEach(param => {
            result = result.replace(`{${param}}`, params[param]);
        });
        
        return result;
    }

    // Update page language and direction
    updatePageLanguage() {
        const html = document.documentElement;
        const isRTL = this.isRTL();
        
        // Set language and direction
        html.setAttribute('lang', this.currentLanguage);
        html.setAttribute('dir', isRTL ? 'rtl' : 'ltr');
        
        // Update all elements with data-translate attribute
        this.updateTranslatedElements();
        
        // Update placeholders
        this.updatePlaceholders();
        
        // Update language switcher
        this.updateLanguageSwitcher();
        
        // Trigger language change event
        document.dispatchEvent(new CustomEvent('languageChanged', {
            detail: { language: this.currentLanguage, isRTL }
        }));
    }

    // Update all elements with data-translate attribute
    updateTranslatedElements() {
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            element.textContent = this.translate(key);
        });
    }

    // Update placeholder texts
    updatePlaceholders() {
        const elements = document.querySelectorAll('[data-translate-placeholder]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate-placeholder');
            element.placeholder = this.translate(key);
        });
    }

    // Update language switcher display
    updateLanguageSwitcher() {
        const currentLangElement = document.querySelector('.current-lang');
        if (currentLangElement) {
            const languageNames = {
                ar: 'العربية',
                fr: 'Français',
                en: 'English'
            };
            currentLangElement.textContent = languageNames[this.currentLanguage];
        }
    }

    // Get language name in its own language
    getLanguageName(language) {
        const names = {
            ar: 'العربية',
            fr: 'Français',
            en: 'English'
        };
        return names[language] || language;
    }

    // Format number according to language
    formatNumber(number, options = {}) {
        const locale = {
            ar: 'ar-DZ',
            fr: 'fr-DZ',
            en: 'en-US'
        }[this.currentLanguage] || 'en-US';
        
        return new Intl.NumberFormat(locale, options).format(number);
    }

    // Format currency according to language
    formatCurrency(amount, currency = 'DZD') {
        const locale = {
            ar: 'ar-DZ',
            fr: 'fr-DZ',
            en: 'en-US'
        }[this.currentLanguage] || 'en-US';
        
        return new Intl.NumberFormat(locale, {
            style: 'currency',
            currency: currency
        }).format(amount);
    }

    // Format date according to language
    formatDate(date, options = {}) {
        const locale = {
            ar: 'ar-DZ',
            fr: 'fr-DZ',
            en: 'en-US'
        }[this.currentLanguage] || 'en-US';
        
        return new Intl.DateTimeFormat(locale, options).format(new Date(date));
    }
}

// Create global translation manager instance
const T = new TranslationManager();

// Global translation function
function t(key, params = {}) {
    return T.translate(key, params);
}

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { TRANSLATIONS, TranslationManager, T, t };
}

